# read https://docs.wandb.ai/guides/sweeps/sweep-config-keys/#distribution-options-for-random-and-bayesian-search
program: nchw73-agent-code.py # The script the agent will run
method: bayes # Or 'random' or 'grid'
metric:
  name: TrackedInfo/r_mean_ # Metric to optimize (must match wandb.log key)
  goal: maximize # maximize, minimize
parameters:
  # AGENT PARAMETERS (see TQC paper experiments)
  # n_mini_critics:
  #   values: [1, 2, 3, 5, 10]
  # n_quantiles:
  #   values: [10, 15, 25, 35, 50] # (n_to_drop automatic)
  # discount: # Gamma
  #   values: [0.98, 0.99]
  # tau:
  #   values: [0.001, 0.005, 0.01]
  # actor_lr:
  #   max: 0.0006
  #   min: 0.00015
  #   distribution: uniform
  # critic_lr:
  #   max: 0.0006
  #   min: 0.00015
  #   distribution: uniform
  # alpha_lr:
  #   max: 0.0006
  #   min: 0.00015
  #   distribution: uniform
  
  ## ERE BUFFER ##
  buffer_size:
    # values: [100000, 200000, 500000, 1000000] # tested in paper
    values: [500000, 1000000]
  eta0:
    values: [0.994, 0.995, 0.996, 0.997, 0.998, 0.999]
  # annealing_steps:
  #   values: [100000, 200000, 250000, 300000, 350000, 400000] # 200 ep = max. 400k steps
  # cmin:
  #   max: 10000
  #   min: 2500
  #   distribution: int_uniform
  
  ## DREAMER PARAMETERS ##
  # use_dreamer: # if false make sure to comment out the dreamer parameters!
  #   values: [True, False]
  # hidden_dim:
  #   values: [128, 256, 512]
  # num_layers:
  #   max: 32
  #   min: 8
  #   distribution: int_uniform
  # num_heads:
  #   max: 8
  #   min: 4
  #   distribution: int_uniform
  # dreamer_lr:
  #   distribution: log_uniform_values
  #   min: 1e-5
  #   max: 1e-3
  # dropout_prob:
  #   max: 0.2
  #   min: 0.05
  #   distribution: uniform
  # step_size:
  #   values: [1, 2]
  # dreamer_train_frequency:
  #   max: 20
  #   min: 5
  #   distribution: int_uniform
  # dreamer_train_epochs:
  #   max: 20
  #   min: 5
  #   distribution: int_uniform
  imagination_horizon:
    max: 50 # as a starting point
    min: 10
    distribution: int_uniform
  # score_threshold:
  #   values: [0.7, 0.8, 0.9]
  # episode_threshold:
  #   values: [20, 30, 50]
    
    

# --- Optional: Early Termination ---
early_terminate:
  type: hyperband
  min_iter: 800
  # s: 2 # Number of brackets (optional)
  # eta: 3 # Halving rate (optional)

command:
  - ${env}        # Passes environment variables
  - python3       # Explicitly use the python3 interpreter
  - ${program}    # The program script defined above (nchw73-agent-code.py)
  - ${args}       # Passes the hyperparameters generated by the sweep