# read https://docs.wandb.ai/guides/sweeps/sweep-config-keys/#distribution-options-for-random-and-bayesian-search
program: nchw73-agent-code.py # The script the agent will run
method: bayes # bayes, random or grid
metric:
  name: TrackedInfo/r_mean_ # Metric to optimize (must match wandb.log key)
  goal: maximize # maximize, minimize

early_terminate: # --- Optional: Early Termination 
  type: hyperband
  min_iter: 150
  # s: 2 # Number of brackets (optional)
  # eta: 3 # Halving rate (optional)

parameters:
  hardcore:
    value: False
  max_episodes:
    value: 349
    
  # AGENT PARAMETERS (see TQC paper experiments)
  # init_rand_steps:
  #   values: [100, 1000, 10000]
  # batch_size:
  #   values: [64, 100, 128, 256]
  # n_mini_critics:
  #   values: [2, 3, 5, 10]
  # n_quantiles: # aka n_atoms
  #   # values: [10, 15, 25, 35, 50] # (n_to_drop automatic)
  #   values: [15, 20, 25, 30, 35]
  # discount: # Gamma
  #   values: [0.98, 0.99]
  # tau:
  #   values: [0.005, 0.01, 0.02]
  # actor_lr:
  #   max: 0.0005
  #   min: 0.00025
  #   distribution: log_uniform_values
  # critic_lr:
  #   max: 0.0005
  #   min: 0.00025
  #   distribution: log_uniform_values
  # alpha_lr:
  #   max: 0.0005
  #   min: 0.00025
  #   distribution: log_uniform_values
  
  ## ERE BUFFER ##
  # buffer_size:
  #   values: [100000, 200000, 500000, 1000000] # tested in paper
    # values: [500000, 1000000]
  # eta0:
  #   values: [0.994, 0.995, 0.996, 0.997, 0.998, 0.999]
  # annealing_steps:
  #   values: [100000, 200000, 250000, 300000, 350000, 400000] # 200 ep = max. 400k steps
  # cmin:
  #   max: 10000
  #   min: 2500
  #   distribution: int_uniform
  
  ## DREAMER PARAMETERS ##
  use_dreamer: # if false make sure to comment out the dreamer parameters!
    # values: [True, False]
    value: True
  # intrinsic_reward_scale:
  #   values: [0, 0.01, 0.1]
  hidden_dim:
    values: [128, 256, 512]
  num_layers:
    values: [4, 6, 8, 16]
  num_heads:
    values: [4, 8]
  dreamer_lr:
    max: 0.0005
    min: 0.00025
    distribution: log_uniform_values
  window_size:
    values: [30, 40, 50]
  # dropout_prob:
  #   max: 0.2
  #   min: 0.05
  #   distribution: uniform
  # step_size:
  #   values: [1, 2]
  dreamer_train_frequency:
    values: [5, 10, 15]
  # dreamer_train_epochs:
  #   max: 20
  #   min: 5
  #   distribution: int_uniform
  imagination_horizon:
    values: [10, 15, 20]
  loss_threshold:
    values: [0.8, 0.9]
  # episode_threshold:
  #   values: [20, 30, 50]


command:
  - ${env}        # Passes environment variables
  - python3       # Explicitly use the python3 interpreter
  - ${program}    # The program script defined above (nchw73-agent-code.py)
  - ${args}       # Passes the hyperparameters generated by the sweep